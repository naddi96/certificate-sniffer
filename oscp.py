from cryptography import x509
from cryptography.x509 import ExtensionOID,ocsp
import binascii
from cryptography.hazmat.primitives import serialization
from cryptography.hazmat.primitives.hashes import SHA1
import requests
from validators import domain, url




def extract_ocsp_result(ocsp_response):

    """ Extract the OCSP result from the provided ocsp_response """

    func_name: str = "extract_ocsp_result"

    try:
        ocsp_response = ocsp.load_der_ocsp_response(ocsp_response.content)
        # OCSP Response Status here:
        # https://cryptography.io/en/latest/_modules/cryptography/x509/ocsp/#OCSPResponseStatus
        # A status of 0 == OCSPResponseStatus.SUCCESSFUL
        if str(ocsp_response.response_status.value) != "0":
            # This will return one of five errors, which means connecting
            # to the OCSP Responder failed for one of the below reasons:
            # MALFORMED_REQUEST = 1
            # INTERNAL_ERROR = 2
            # TRY_LATER = 3
            # SIG_REQUIRED = 5
            # UNAUTHORIZED = 6
            ocsp_response = str(ocsp_response.response_status)
            ocsp_response = ocsp_response.split(".")
            raise Exception(f"{func_name}: OCSP Request Error: {ocsp_response[1]}")

        certificate_status = str(ocsp_response.certificate_status)
        certificate_status = certificate_status.split(".")
        return f"OCSP Status: {certificate_status[1]}"

    except ValueError as err:
        return f"{func_name}: {str(err)}"




def get_ocsp_response(ocsp_url: str, ocsp_request_data: bytes):

    """ Send OCSP request to ocsp responder and retrieve response """

    func_name: str = "get_ocsp_response"

    # Confirm that the ocsp_url is a valid url
    if not url(ocsp_url):
        raise Exception(f"{func_name}: URL failed validation for {ocsp_url}")

    try:
        ocsp_response = requests.post(
            ocsp_url,
            headers={"Content-Type": "application/ocsp-request"},
            data=ocsp_request_data,
            timeout=5,
        )

    except requests.exceptions.Timeout:
        raise Exception(f"{func_name}: Request timeout for {ocsp_url}") from None

    except requests.exceptions.ConnectionError:
        raise Exception(f"{func_name}: Unknown Connection Error to {ocsp_url}") from None

    except requests.exceptions.RequestException:
        raise Exception(f"{func_name}: Unknown Connection Error to {ocsp_url}") from None

    return ocsp_response



def controlla_oscp(cerrt_chain_list):
    try:
        leaf_cert  = x509.load_der_x509_certificate(
                binascii.unhexlify(cerrt_chain_list[0].replace(":","")))


        aia_extensions = leaf_cert.extensions.get_extension_for_oid(
            ExtensionOID.AUTHORITY_INFORMATION_ACCESS
        ).value

        ocsp_url=''
        for index, value in enumerate(aia_extensions):
                if aia_extensions[index].access_method._name == "OCSP":
                    ocsp_url = aia_extensions[index].access_location.value
        
        if (ocsp_url==""):  return "OCSP NON PRESENTE"

        issuer_cert  = x509.load_der_x509_certificate(
            binascii.unhexlify(cerrt_chain_list[1].replace(":","")))


        builder = ocsp.OCSPRequestBuilder()
        builder = builder.add_certificate(leaf_cert, issuer_cert, SHA1())
        ocsp_data = builder.build()
        ocsp_request_data = ocsp_data.public_bytes(serialization.Encoding.DER)
        

        cc=get_ocsp_response(ocsp_url,ocsp_request_data)

        result = extract_ocsp_result(cc)
        return result
    except Exception as err:
        print("Error "+str(err))
        return "Error "+str(err)


if __name__ == '__main__':
    cert3="30:82:07:bd:30:82:05:a5:a0:03:02:01:02:02:13:7f:00:00:60:63:de:96:e9:1c:68:8c:f9:28:00:00:00:00:60:63:30:0d:06:09:2a:86:48:86:f7:0d:01:01:0b:05:00:30:4f:31:0b:30:09:06:03:55:04:06:13:02:55:53:31:1e:30:1c:06:03:55:04:0a:13:15:4d:69:63:72:6f:73:6f:66:74:20:43:6f:72:70:6f:72:61:74:69:6f:6e:31:20:30:1e:06:03:55:04:03:13:17:4d:69:63:72:6f:73:6f:66:74:20:52:53:41:20:54:4c:53:20:43:41:20:30:32:30:1e:17:0d:32:30:31:30:30:35:32:31:32:39:31:31:5a:17:0d:32:31:31:30:30:35:32:31:32:39:31:31:5a:30:26:31:24:30:22:06:03:55:04:03:0c:1b:2a:2e:76:6f:72:74:65:78:2e:64:61:74:61:2e:6d:69:63:72:6f:73:6f:66:74:2e:63:6f:6d:30:82:01:22:30:0d:06:09:2a:86:48:86:f7:0d:01:01:01:05:00:03:82:01:0f:00:30:82:01:0a:02:82:01:01:00:e5:6f:69:77:0a:f7:6d:d2:2e:5d:95:1d:30:64:47:6d:39:b9:2b:55:ea:ad:bb:2d:a6:c9:7e:89:77:92:50:73:87:9e:70:15:b3:7b:5f:64:c4:57:b7:3b:16:55:af:fc:20:c0:02:96:a5:aa:50:76:1e:70:ef:79:c1:4c:b3:5a:91:8e:7d:72:1b:4b:7d:86:54:59:11:14:c6:38:24:12:cb:a4:e6:a3:db:f9:b9:c6:4f:8a:c9:ae:fd:2a:be:e1:b9:6a:17:12:57:a9:e0:1e:cf:44:e4:c9:a9:9b:fc:e5:28:03:94:9a:ee:e6:7e:5a:3a:b0:dd:cc:34:a8:fd:8a:3a:4a:d8:8e:7a:64:3f:ef:b1:23:48:ee:7b:2a:d1:aa:be:6f:aa:51:27:1d:ad:3a:2c:c4:b2:50:0d:2b:32:6a:30:60:10:ec:7d:95:93:0e:d3:45:58:24:01:df:09:17:a0:95:fb:c9:93:86:61:26:8c:65:bc:68:66:77:38:c3:02:9a:c3:72:87:cd:6c:4d:df:68:4f:60:ac:e0:e7:c0:7d:71:af:19:59:6b:09:3e:c3:ac:be:6c:cc:f0:8b:84:62:98:7a:be:4d:99:89:54:a9:f9:59:e1:c2:32:4a:8f:77:f3:38:bf:12:d4:d3:06:a6:30:48:5a:ac:f6:ea:71:02:03:01:00:01:a3:82:03:b9:30:82:03:b5:30:82:01:03:06:0a:2b:06:01:04:01:d6:79:02:04:02:04:81:f4:04:81:f1:00:ef:00:74:00:7d:3e:f2:f8:8f:ff:88:55:68:24:c2:c0:ca:9e:52:89:79:2b:c5:0e:78:09:7f:2e:6a:97:68:99:7e:22:f0:d7:00:00:01:74:fa:b4:4f:32:00:00:04:03:00:45:30:43:02:1f:30:6f:82:59:67:00:b4:0b:9d:eb:ba:8c:b8:fe:4d:a0:24:29:f0:93:95:26:14:f9:7b:e3:f6:24:46:9b:21:02:20:72:a1:32:ef:c2:ec:cf:0d:ed:1a:40:1e:e6:cb:9e:71:da:9f:b4:0e:5f:5e:5d:09:25:6a:19:09:ee:d7:13:93:00:77:00:ee:c0:95:ee:8d:72:64:0f:92:e3:c3:b9:1b:c7:12:a3:69:6a:09:7b:4b:6a:1a:14:38:e6:47:b2:cb:ed:c5:f9:00:00:01:74:fa:b4:51:00:00:00:04:03:00:48:30:46:02:21:00:8f:a5:23:f8:19:8d:c7:58:31:2e:42:d4:fa:4c:47:a8:f3:aa:aa:0a:73:f8:64:44:5c:39:7c:33:58:b0:06:b7:02:21:00:ce:5d:a5:e7:6c:d1:87:4c:86:17:43:f6:bc:9e:9b:be:6f:06:ff:48:cd:b3:2d:f9:f8:2a:05:cb:1c:44:6a:f5:30:27:06:09:2b:06:01:04:01:82:37:15:0a:04:1a:30:18:30:0a:06:08:2b:06:01:05:05:07:03:01:30:0a:06:08:2b:06:01:05:05:07:03:02:30:3e:06:09:2b:06:01:04:01:82:37:15:07:04:31:30:2f:06:27:2b:06:01:04:01:82:37:15:08:87:da:86:75:83:ee:d9:01:82:c9:85:1b:81:b5:9e:61:85:f4:eb:60:81:5d:85:86:8e:41:87:c2:98:50:02:01:64:02:01:25:30:81:87:06:08:2b:06:01:05:05:07:01:01:04:7b:30:79:30:53:06:08:2b:06:01:05:05:07:30:02:86:47:68:74:74:70:3a:2f:2f:77:77:77:2e:6d:69:63:72:6f:73:6f:66:74:2e:63:6f:6d:2f:70:6b:69:2f:6d:73:63:6f:72:70:2f:4d:69:63:72:6f:73:6f:66:74:25:32:30:52:53:41:25:32:30:54:4c:53:25:32:30:43:41:25:32:30:30:32:2e:63:72:74:30:22:06:08:2b:06:01:05:05:07:30:01:86:16:68:74:74:70:3a:2f:2f:6f:63:73:70:2e:6d:73:6f:63:73:70:2e:63:6f:6d:30:1d:06:03:55:1d:0e:04:16:04:14:a9:54:48:21:a7:6e:cd:8c:0e:ca:9c:2c:46:ca:9c:23:32:2e:b8:84:30:0b:06:03:55:1d:0f:04:04:03:02:04:b0:30:41:06:03:55:1d:11:04:3a:30:38:82:1b:2a:2e:76:6f:72:74:65:78:2e:64:61:74:61:2e:6d:69:63:72:6f:73:6f:66:74:2e:63:6f:6d:82:19:76:6f:72:74:65:78:2e:64:61:74:61:2e:6d:69:63:72:6f:73:6f:66:74:2e:63:6f:6d:30:81:b0:06:03:55:1d:1f:04:81:a8:30:81:a5:30:81:a2:a0:81:9f:a0:81:9c:86:4d:68:74:74:70:3a:2f:2f:6d:73:63:72:6c:2e:6d:69:63:72:6f:73:6f:66:74:2e:63:6f:6d:2f:70:6b:69:2f:6d:73:63:6f:72:70:2f:63:72:6c:2f:4d:69:63:72:6f:73:6f:66:74:25:32:30:52:53:41:25:32:30:54:4c:53:25:32:30:43:41:25:32:30:30:32:2e:63:72:6c:86:4b:68:74:74:70:3a:2f:2f:63:72:6c:2e:6d:69:63:72:6f:73:6f:66:74:2e:63:6f:6d:2f:70:6b:69:2f:6d:73:63:6f:72:70:2f:63:72:6c:2f:4d:69:63:72:6f:73:6f:66:74:25:32:30:52:53:41:25:32:30:54:4c:53:25:32:30:43:41:25:32:30:30:32:2e:63:72:6c:30:57:06:03:55:1d:20:04:50:30:4e:30:42:06:09:2b:06:01:04:01:82:37:2a:01:30:35:30:33:06:08:2b:06:01:05:05:07:02:01:16:27:68:74:74:70:3a:2f:2f:77:77:77:2e:6d:69:63:72:6f:73:6f:66:74:2e:63:6f:6d:2f:70:6b:69:2f:6d:73:63:6f:72:70:2f:63:70:73:30:08:06:06:67:81:0c:01:02:01:30:1f:06:03:55:1d:23:04:18:30:16:80:14:ff:2f:7f:e1:06:f4:38:f3:2d:ed:25:8d:98:c2:fe:0e:f6:6c:fc:fa:30:1d:06:03:55:1d:25:04:16:30:14:06:08:2b:06:01:05:05:07:03:01:06:08:2b:06:01:05:05:07:03:02:30:0d:06:09:2a:86:48:86:f7:0d:01:01:0b:05:00:03:82:02:01:00:5d:19:ab:ef:2e:2e:ba:8b:78:b2:8b:12:11:d0:fc:71:77:5c:8f:9f:f5:c5:88:f5:3c:48:9c:2c:3c:98:69:1d:d4:e2:0d:f8:5b:6d:de:52:1c:af:c4:e6:a0:7a:70:c3:87:f8:3c:bd:b0:0b:78:dc:2d:22:bb:5b:c9:b6:77:e6:d4:91:16:83:6e:2b:b0:e3:41:35:ff:75:80:90:22:a3:77:3a:e9:a1:84:e1:e6:62:b4:7b:e5:65:75:ce:0a:b0:14:16:15:10:cb:22:7a:10:37:bb:3a:af:3e:78:e4:58:c6:5f:e5:65:65:12:e2:c1:31:13:49:d8:ba:0e:c4:fe:7e:af:24:5c:c3:75:61:79:3d:ec:96:25:4b:e1:55:5c:9f:56:60:bc:3e:05:87:cc:9a:72:11:47:0d:54:9a:ec:ce:22:5c:9d:26:60:1d:3b:42:07:a3:3b:54:aa:c6:c8:37:b7:a9:5e:ce:a9:ca:fd:df:c3:e4:24:10:10:9b:22:f6:96:d9:bc:fc:e1:b0:43:8e:ab:53:6f:0e:f2:ed:a8:c5:80:b5:33:ea:45:df:9e:08:9a:f3:bc:b3:1a:8e:bd:3f:85:d0:23:0e:ae:92:9a:50:8a:4a:10:5c:bf:3c:b0:88:1f:3d:d0:02:86:d5:e8:2b:c2:31:39:7b:92:86:f3:82:c5:b8:0b:16:c2:dd:be:b6:fd:9e:e2:44:d5:f1:e6:15:86:f4:b6:de:7a:5b:f6:d6:4f:3c:0d:99:51:95:29:28:55:76:ea:2a:82:32:00:b4:43:dd:6f:d6:f9:89:68:42:a9:0b:df:02:e1:8b:79:23:c7:09:1f:3f:9d:ab:4e:03:98:59:80:61:93:dc:c2:cf:e9:4d:6e:da:86:10:41:8c:da:66:41:f2:44:fb:a7:d3:b8:ca:05:bf:f0:90:f1:a9:6a:05:1c:a3:3e:70:44:51:ee:2a:b6:6b:4b:f9:0c:e1:8b:6f:09:51:55:eb:46:7b:5e:10:87:d4:d6:c8:ac:25:ce:8d:f0:c6:11:5a:e1:17:e3:60:79:f2:2c:82:23:6e:c2:06:fe:de:a0:86:eb:f3:77:ef:49:53:d2:5c:90:9b:1a:90:85:14:71:5b:bd:d2:1c:94:b8:d3:88:2d:7a:5c:59:21:4b:19:38:8c:25:98:91:af:2b:04:67:94:fb:16:9a:8e:04:bf:80:0b:e8:1f:77:0d:83:a9:cc:4f:74:7c:0c:49:a7:a1:1d:7a:a4:cc:c4:b8:6d:a2:63:19:ee:07:46:2c:6c:ca:7b:c5:41:52:68:6f:b9:dd:7e:f2:0f:29:a0:e3:07:23:4a:ac:99:b4:40:d3:7b:cd:11:b6:a1"
    cer3="30:82:06:bf:30:82:05:a7:a0:03:02:01:02:02:10:06:df:d9:4f:40:3c:8f:9b:2e:12:1c:2e:0d:99:47:74:30:0d:06:09:2a:86:48:86:f7:0d:01:01:0b:05:00:30:44:31:0b:30:09:06:03:55:04:06:13:02:55:53:31:15:30:13:06:03:55:04:0a:13:0c:44:69:67:69:43:65:72:74:20:49:6e:63:31:1e:30:1c:06:03:55:04:03:13:15:44:69:67:69:43:65:72:74:20:47:6c:6f:62:61:6c:20:43:41:20:47:32:30:1e:17:0d:32:30:31:31:31:30:30:30:30:30:30:30:5a:17:0d:32:31:31:31:30:34:32:33:35:39:35:39:5a:30:67:31:0b:30:09:06:03:55:04:06:13:02:55:53:31:13:30:11:06:03:55:04:08:13:0a:57:61:73:68:69:6e:67:74:6f:6e:31:10:30:0e:06:03:55:04:07:13:07:53:65:61:74:74:6c:65:31:19:30:17:06:03:55:04:0a:13:10:41:6d:61:7a:6f:6e:2e:63:6f:6d:2c:20:49:6e:63:2e:31:16:30:14:06:03:55:04:03:13:0d:77:77:77:2e:61:6d:61:7a:6f:6e:2e:69:74:30:82:01:22:30:0d:06:09:2a:86:48:86:f7:0d:01:01:01:05:00:03:82:01:0f:00:30:82:01:0a:02:82:01:01:00:c5:1d:57:45:2b:0c:47:ac:42:b5:64:29:21:ac:1e:6b:f2:36:f1:5c:8d:e4:73:e0:6f:e0:9f:9f:a2:ac:63:1c:67:f5:11:fb:e5:48:c9:fa:88:d0:6b:12:5f:21:67:58:a7:65:cb:37:d3:d6:16:7c:81:02:2c:c1:00:3f:77:66:6f:a5:ad:23:a6:f5:35:35:a6:51:6a:60:8d:98:d4:66:e3:ad:9c:13:cb:f9:4a:a6:33:c9:eb:2b:a6:88:cb:c8:73:a0:a5:ad:f4:b7:bc:2d:cb:d9:ce:ef:70:db:e1:da:f8:50:c5:b8:17:65:22:d2:4e:cd:82:fd:4d:7c:3b:7e:83:3a:29:42:19:e1:ab:90:4d:12:68:aa:1d:ed:74:e5:08:56:b8:09:06:b8:69:0b:ae:30:f1:81:8c:a0:e5:14:bc:b7:11:a0:26:12:69:18:14:3d:af:0d:5a:96:7f:8b:6d:49:f0:20:a6:ee:a2:b1:af:29:3f:63:58:62:14:29:cb:26:56:2e:56:3d:e5:d9:71:34:7b:ca:08:df:a0:b1:d2:de:c5:89:69:7c:d4:dc:ed:0a:d1:8a:b6:a4:e4:95:aa:8b:64:93:fe:c2:d4:31:21:c7:21:e4:28:10:56:e3:ac:bd:d4:0a:9e:24:38:8c:7a:17:bd:7f:07:a9:d1:97:02:03:01:00:01:a3:82:03:88:30:82:03:84:30:1f:06:03:55:1d:23:04:18:30:16:80:14:24:6e:2b:2d:d0:6a:92:51:51:25:69:01:aa:9a:47:a6:89:e7:40:20:30:1d:06:03:55:1d:0e:04:16:04:14:a9:10:2a:c4:4e:68:42:cc:48:9a:60:94:af:8e:0c:05:c1:ba:98:4f:30:81:c2:06:03:55:1d:11:04:81:ba:30:81:b7:82:11:77:77:77:2e:63:64:6e:2e:61:6d:61:7a:6f:6e:2e:69:74:82:0d:77:77:77:2e:61:6d:61:7a:6f:6e:2e:69:74:82:23:70:2d:79:6f:2d:77:77:77:2d:61:6d:61:7a:6f:6e:2d:69:74:2d:6b:61:6c:69:61:73:2e:61:6d:61:7a:6f:6e:2e:69:74:82:23:70:2d:79:33:2d:77:77:77:2d:61:6d:61:7a:6f:6e:2d:69:74:2d:6b:61:6c:69:61:73:2e:61:6d:61:7a:6f:6e:2e:69:74:82:23:70:2d:6e:74:2d:77:77:77:2d:61:6d:61:7a:6f:6e:2d:69:74:2d:6b:61:6c:69:61:73:2e:61:6d:61:7a:6f:6e:2e:69:74:82:19:6d:61:74:63:68:2e:61:6d:61:7a:6f:6e:62:72:6f:77:73:65:72:61:70:70:2e:69:74:82:09:61:6d:61:7a:6f:6e:2e:69:74:30:0e:06:03:55:1d:0f:01:01:ff:04:04:03:02:05:a0:30:1d:06:03:55:1d:25:04:16:30:14:06:08:2b:06:01:05:05:07:03:01:06:08:2b:06:01:05:05:07:03:02:30:77:06:03:55:1d:1f:04:70:30:6e:30:35:a0:33:a0:31:86:2f:68:74:74:70:3a:2f:2f:63:72:6c:33:2e:64:69:67:69:63:65:72:74:2e:63:6f:6d:2f:44:69:67:69:43:65:72:74:47:6c:6f:62:61:6c:43:41:47:32:2e:63:72:6c:30:35:a0:33:a0:31:86:2f:68:74:74:70:3a:2f:2f:63:72:6c:34:2e:64:69:67:69:63:65:72:74:2e:63:6f:6d:2f:44:69:67:69:43:65:72:74:47:6c:6f:62:61:6c:43:41:47:32:2e:63:72:6c:30:4c:06:03:55:1d:20:04:45:30:43:30:37:06:09:60:86:48:01:86:fd:6c:01:01:30:2a:30:28:06:08:2b:06:01:05:05:07:02:01:16:1c:68:74:74:70:73:3a:2f:2f:77:77:77:2e:64:69:67:69:63:65:72:74:2e:63:6f:6d:2f:43:50:53:30:08:06:06:67:81:0c:01:02:02:30:74:06:08:2b:06:01:05:05:07:01:01:04:68:30:66:30:24:06:08:2b:06:01:05:05:07:30:01:86:18:68:74:74:70:3a:2f:2f:6f:63:73:70:2e:64:69:67:69:63:65:72:74:2e:63:6f:6d:30:3e:06:08:2b:06:01:05:05:07:30:02:86:32:68:74:74:70:3a:2f:2f:63:61:63:65:72:74:73:2e:64:69:67:69:63:65:72:74:2e:63:6f:6d:2f:44:69:67:69:43:65:72:74:47:6c:6f:62:61:6c:43:41:47:32:2e:63:72:74:30:09:06:03:55:1d:13:04:02:30:00:30:82:01:04:06:0a:2b:06:01:04:01:d6:79:02:04:02:04:81:f5:04:81:f2:00:f0:00:75:00:f6:5c:94:2f:d1:77:30:22:14:54:18:08:30:94:56:8e:e3:4d:13:19:33:bf:df:0c:2f:20:0b:cc:4e:f1:64:e3:00:00:01:75:af:e6:fd:d5:00:00:04:03:00:46:30:44:02:20:16:41:ef:5f:b3:0b:b9:a8:ca:7a:b6:7e:dc:74:e5:05:17:74:57:01:3e:0a:f2:87:a0:1a:39:08:24:16:2e:42:02:20:51:b0:74:c4:41:b7:5c:b9:b1:4d:e8:33:2c:f2:2c:0e:e0:68:58:d8:1a:c8:a4:48:35:4b:44:44:95:f0:5d:57:00:77:00:5c:dc:43:92:fe:e6:ab:45:44:b1:5e:9a:d4:56:e6:10:37:fb:d5:fa:47:dc:a1:73:94:b2:5e:e6:f6:c7:0e:ca:00:00:01:75:af:e6:fe:2f:00:00:04:03:00:48:30:46:02:21:00:8a:6f:a9:be:fc:8c:c8:76:3e:97:c6:3d:b1:8b:d8:d0:d2:a0:b8:8c:b4:b1:5f:42:9e:f9:6f:e3:7a:7f:be:31:02:21:00:bb:63:a9:b6:ee:60:f4:2d:36:0d:52:a4:1b:aa:82:92:e6:61:91:b5:9d:e4:3c:9a:22:22:30:37:be:51:ba:4c:30:0d:06:09:2a:86:48:86:f7:0d:01:01:0b:05:00:03:82:01:01:00:07:54:42:76:02:f5:bb:c2:7e:37:a0:2c:ab:23:ae:fb:35:b3:94:00:d7:e3:f8:dd:7d:4c:66:a6:75:4e:20:29:76:6a:32:55:09:ad:5d:ba:f2:ee:cb:9b:c6:1b:ad:75:c8:d1:57:8b:19:fc:76:8f:1f:a5:c4:a7:5a:ef:e1:74:99:23:e6:6e:b5:ce:5c:ca:b5:65:77:0b:c3:1d:a8:6b:3f:51:b4:69:73:a7:5b:ce:0f:bf:00:9c:23:18:34:f0:a1:64:be:c4:d1:c3:d1:2d:2c:5f:47:e2:2f:71:1f:a1:4a:e3:4d:d7:6f:d6:73:41:7e:62:ae:17:2a:29:5d:f6:93:67:7e:33:d3:ef:e3:cb:e8:9a:41:9b:27:0b:a9:8c:0c:b4:95:35:15:07:12:89:c0:a3:50:98:13:bb:03:6f:19:42:60:79:19:2d:23:73:6f:5b:46:33:7e:85:9b:c6:a9:bf:3d:05:36:b7:01:2b:4f:10:ab:df:33:16:b4:03:b4:9f:8e:8e:04:50:a2:29:2e:01:4e:f0:91:38:82:ed:eb:6f:db:a3:65:86:25:c9:30:89:7f:dd:4b:dc:cc:0b:6d:d2:0f:a7:48:f3:d7:f5:2b:41:e0:19:a2:0c:1b:47:d8:80:9f:b1:be:84:39:3d:e0:df:fa:96:06:c0:93:a1"

    chain=["30:82:07:bd:30:82:05:a5:a0:03:02:01:02:02:13:7f:00:00:60:63:de:96:e9:1c:68:8c:f9:28:00:00:00:00:60:63:30:0d:06:09:2a:86:48:86:f7:0d:01:01:0b:05:00:30:4f:31:0b:30:09:06:03:55:04:06:13:02:55:53:31:1e:30:1c:06:03:55:04:0a:13:15:4d:69:63:72:6f:73:6f:66:74:20:43:6f:72:70:6f:72:61:74:69:6f:6e:31:20:30:1e:06:03:55:04:03:13:17:4d:69:63:72:6f:73:6f:66:74:20:52:53:41:20:54:4c:53:20:43:41:20:30:32:30:1e:17:0d:32:30:31:30:30:35:32:31:32:39:31:31:5a:17:0d:32:31:31:30:30:35:32:31:32:39:31:31:5a:30:26:31:24:30:22:06:03:55:04:03:0c:1b:2a:2e:76:6f:72:74:65:78:2e:64:61:74:61:2e:6d:69:63:72:6f:73:6f:66:74:2e:63:6f:6d:30:82:01:22:30:0d:06:09:2a:86:48:86:f7:0d:01:01:01:05:00:03:82:01:0f:00:30:82:01:0a:02:82:01:01:00:e5:6f:69:77:0a:f7:6d:d2:2e:5d:95:1d:30:64:47:6d:39:b9:2b:55:ea:ad:bb:2d:a6:c9:7e:89:77:92:50:73:87:9e:70:15:b3:7b:5f:64:c4:57:b7:3b:16:55:af:fc:20:c0:02:96:a5:aa:50:76:1e:70:ef:79:c1:4c:b3:5a:91:8e:7d:72:1b:4b:7d:86:54:59:11:14:c6:38:24:12:cb:a4:e6:a3:db:f9:b9:c6:4f:8a:c9:ae:fd:2a:be:e1:b9:6a:17:12:57:a9:e0:1e:cf:44:e4:c9:a9:9b:fc:e5:28:03:94:9a:ee:e6:7e:5a:3a:b0:dd:cc:34:a8:fd:8a:3a:4a:d8:8e:7a:64:3f:ef:b1:23:48:ee:7b:2a:d1:aa:be:6f:aa:51:27:1d:ad:3a:2c:c4:b2:50:0d:2b:32:6a:30:60:10:ec:7d:95:93:0e:d3:45:58:24:01:df:09:17:a0:95:fb:c9:93:86:61:26:8c:65:bc:68:66:77:38:c3:02:9a:c3:72:87:cd:6c:4d:df:68:4f:60:ac:e0:e7:c0:7d:71:af:19:59:6b:09:3e:c3:ac:be:6c:cc:f0:8b:84:62:98:7a:be:4d:99:89:54:a9:f9:59:e1:c2:32:4a:8f:77:f3:38:bf:12:d4:d3:06:a6:30:48:5a:ac:f6:ea:71:02:03:01:00:01:a3:82:03:b9:30:82:03:b5:30:82:01:03:06:0a:2b:06:01:04:01:d6:79:02:04:02:04:81:f4:04:81:f1:00:ef:00:74:00:7d:3e:f2:f8:8f:ff:88:55:68:24:c2:c0:ca:9e:52:89:79:2b:c5:0e:78:09:7f:2e:6a:97:68:99:7e:22:f0:d7:00:00:01:74:fa:b4:4f:32:00:00:04:03:00:45:30:43:02:1f:30:6f:82:59:67:00:b4:0b:9d:eb:ba:8c:b8:fe:4d:a0:24:29:f0:93:95:26:14:f9:7b:e3:f6:24:46:9b:21:02:20:72:a1:32:ef:c2:ec:cf:0d:ed:1a:40:1e:e6:cb:9e:71:da:9f:b4:0e:5f:5e:5d:09:25:6a:19:09:ee:d7:13:93:00:77:00:ee:c0:95:ee:8d:72:64:0f:92:e3:c3:b9:1b:c7:12:a3:69:6a:09:7b:4b:6a:1a:14:38:e6:47:b2:cb:ed:c5:f9:00:00:01:74:fa:b4:51:00:00:00:04:03:00:48:30:46:02:21:00:8f:a5:23:f8:19:8d:c7:58:31:2e:42:d4:fa:4c:47:a8:f3:aa:aa:0a:73:f8:64:44:5c:39:7c:33:58:b0:06:b7:02:21:00:ce:5d:a5:e7:6c:d1:87:4c:86:17:43:f6:bc:9e:9b:be:6f:06:ff:48:cd:b3:2d:f9:f8:2a:05:cb:1c:44:6a:f5:30:27:06:09:2b:06:01:04:01:82:37:15:0a:04:1a:30:18:30:0a:06:08:2b:06:01:05:05:07:03:01:30:0a:06:08:2b:06:01:05:05:07:03:02:30:3e:06:09:2b:06:01:04:01:82:37:15:07:04:31:30:2f:06:27:2b:06:01:04:01:82:37:15:08:87:da:86:75:83:ee:d9:01:82:c9:85:1b:81:b5:9e:61:85:f4:eb:60:81:5d:85:86:8e:41:87:c2:98:50:02:01:64:02:01:25:30:81:87:06:08:2b:06:01:05:05:07:01:01:04:7b:30:79:30:53:06:08:2b:06:01:05:05:07:30:02:86:47:68:74:74:70:3a:2f:2f:77:77:77:2e:6d:69:63:72:6f:73:6f:66:74:2e:63:6f:6d:2f:70:6b:69:2f:6d:73:63:6f:72:70:2f:4d:69:63:72:6f:73:6f:66:74:25:32:30:52:53:41:25:32:30:54:4c:53:25:32:30:43:41:25:32:30:30:32:2e:63:72:74:30:22:06:08:2b:06:01:05:05:07:30:01:86:16:68:74:74:70:3a:2f:2f:6f:63:73:70:2e:6d:73:6f:63:73:70:2e:63:6f:6d:30:1d:06:03:55:1d:0e:04:16:04:14:a9:54:48:21:a7:6e:cd:8c:0e:ca:9c:2c:46:ca:9c:23:32:2e:b8:84:30:0b:06:03:55:1d:0f:04:04:03:02:04:b0:30:41:06:03:55:1d:11:04:3a:30:38:82:1b:2a:2e:76:6f:72:74:65:78:2e:64:61:74:61:2e:6d:69:63:72:6f:73:6f:66:74:2e:63:6f:6d:82:19:76:6f:72:74:65:78:2e:64:61:74:61:2e:6d:69:63:72:6f:73:6f:66:74:2e:63:6f:6d:30:81:b0:06:03:55:1d:1f:04:81:a8:30:81:a5:30:81:a2:a0:81:9f:a0:81:9c:86:4d:68:74:74:70:3a:2f:2f:6d:73:63:72:6c:2e:6d:69:63:72:6f:73:6f:66:74:2e:63:6f:6d:2f:70:6b:69:2f:6d:73:63:6f:72:70:2f:63:72:6c:2f:4d:69:63:72:6f:73:6f:66:74:25:32:30:52:53:41:25:32:30:54:4c:53:25:32:30:43:41:25:32:30:30:32:2e:63:72:6c:86:4b:68:74:74:70:3a:2f:2f:63:72:6c:2e:6d:69:63:72:6f:73:6f:66:74:2e:63:6f:6d:2f:70:6b:69:2f:6d:73:63:6f:72:70:2f:63:72:6c:2f:4d:69:63:72:6f:73:6f:66:74:25:32:30:52:53:41:25:32:30:54:4c:53:25:32:30:43:41:25:32:30:30:32:2e:63:72:6c:30:57:06:03:55:1d:20:04:50:30:4e:30:42:06:09:2b:06:01:04:01:82:37:2a:01:30:35:30:33:06:08:2b:06:01:05:05:07:02:01:16:27:68:74:74:70:3a:2f:2f:77:77:77:2e:6d:69:63:72:6f:73:6f:66:74:2e:63:6f:6d:2f:70:6b:69:2f:6d:73:63:6f:72:70:2f:63:70:73:30:08:06:06:67:81:0c:01:02:01:30:1f:06:03:55:1d:23:04:18:30:16:80:14:ff:2f:7f:e1:06:f4:38:f3:2d:ed:25:8d:98:c2:fe:0e:f6:6c:fc:fa:30:1d:06:03:55:1d:25:04:16:30:14:06:08:2b:06:01:05:05:07:03:01:06:08:2b:06:01:05:05:07:03:02:30:0d:06:09:2a:86:48:86:f7:0d:01:01:0b:05:00:03:82:02:01:00:5d:19:ab:ef:2e:2e:ba:8b:78:b2:8b:12:11:d0:fc:71:77:5c:8f:9f:f5:c5:88:f5:3c:48:9c:2c:3c:98:69:1d:d4:e2:0d:f8:5b:6d:de:52:1c:af:c4:e6:a0:7a:70:c3:87:f8:3c:bd:b0:0b:78:dc:2d:22:bb:5b:c9:b6:77:e6:d4:91:16:83:6e:2b:b0:e3:41:35:ff:75:80:90:22:a3:77:3a:e9:a1:84:e1:e6:62:b4:7b:e5:65:75:ce:0a:b0:14:16:15:10:cb:22:7a:10:37:bb:3a:af:3e:78:e4:58:c6:5f:e5:65:65:12:e2:c1:31:13:49:d8:ba:0e:c4:fe:7e:af:24:5c:c3:75:61:79:3d:ec:96:25:4b:e1:55:5c:9f:56:60:bc:3e:05:87:cc:9a:72:11:47:0d:54:9a:ec:ce:22:5c:9d:26:60:1d:3b:42:07:a3:3b:54:aa:c6:c8:37:b7:a9:5e:ce:a9:ca:fd:df:c3:e4:24:10:10:9b:22:f6:96:d9:bc:fc:e1:b0:43:8e:ab:53:6f:0e:f2:ed:a8:c5:80:b5:33:ea:45:df:9e:08:9a:f3:bc:b3:1a:8e:bd:3f:85:d0:23:0e:ae:92:9a:50:8a:4a:10:5c:bf:3c:b0:88:1f:3d:d0:02:86:d5:e8:2b:c2:31:39:7b:92:86:f3:82:c5:b8:0b:16:c2:dd:be:b6:fd:9e:e2:44:d5:f1:e6:15:86:f4:b6:de:7a:5b:f6:d6:4f:3c:0d:99:51:95:29:28:55:76:ea:2a:82:32:00:b4:43:dd:6f:d6:f9:89:68:42:a9:0b:df:02:e1:8b:79:23:c7:09:1f:3f:9d:ab:4e:03:98:59:80:61:93:dc:c2:cf:e9:4d:6e:da:86:10:41:8c:da:66:41:f2:44:fb:a7:d3:b8:ca:05:bf:f0:90:f1:a9:6a:05:1c:a3:3e:70:44:51:ee:2a:b6:6b:4b:f9:0c:e1:8b:6f:09:51:55:eb:46:7b:5e:10:87:d4:d6:c8:ac:25:ce:8d:f0:c6:11:5a:e1:17:e3:60:79:f2:2c:82:23:6e:c2:06:fe:de:a0:86:eb:f3:77:ef:49:53:d2:5c:90:9b:1a:90:85:14:71:5b:bd:d2:1c:94:b8:d3:88:2d:7a:5c:59:21:4b:19:38:8c:25:98:91:af:2b:04:67:94:fb:16:9a:8e:04:bf:80:0b:e8:1f:77:0d:83:a9:cc:4f:74:7c:0c:49:a7:a1:1d:7a:a4:cc:c4:b8:6d:a2:63:19:ee:07:46:2c:6c:ca:7b:c5:41:52:68:6f:b9:dd:7e:f2:0f:29:a0:e3:07:23:4a:ac:99:b4:40:d3:7b:cd:11:b6:a1",
                    "30:82:05:5a:30:82:04:42:a0:03:02:01:02:02:10:0f:a7:47:22:c5:3d:88:c8:0f:58:9e:fb:1f:9d:4a:3a:30:0d:06:09:2a:86:48:86:f7:0d:01:01:0b:05:00:30:5a:31:0b:30:09:06:03:55:04:06:13:02:49:45:31:12:30:10:06:03:55:04:0a:13:09:42:61:6c:74:69:6d:6f:72:65:31:13:30:11:06:03:55:04:0b:13:0a:43:79:62:65:72:54:72:75:73:74:31:22:30:20:06:03:55:04:03:13:19:42:61:6c:74:69:6d:6f:72:65:20:43:79:62:65:72:54:72:75:73:74:20:52:6f:6f:74:30:1e:17:0d:32:30:30:37:32:31:32:33:30:30:30:30:5a:17:0d:32:34:31:30:30:38:30:37:30:30:30:30:5a:30:4f:31:0b:30:09:06:03:55:04:06:13:02:55:53:31:1e:30:1c:06:03:55:04:0a:13:15:4d:69:63:72:6f:73:6f:66:74:20:43:6f:72:70:6f:72:61:74:69:6f:6e:31:20:30:1e:06:03:55:04:03:13:17:4d:69:63:72:6f:73:6f:66:74:20:52:53:41:20:54:4c:53:20:43:41:20:30:32:30:82:02:22:30:0d:06:09:2a:86:48:86:f7:0d:01:01:01:05:00:03:82:02:0f:00:30:82:02:0a:02:82:02:01:00:f4:c0:19:59:aa:2a:24:7c:06:21:31:d1:ee:12:f5:81:6a:94:e3:f6:d1:4a:2f:e3:5d:b1:2e:29:14:38:bc:cc:95:5d:29:07:d1:f8:5d:37:f4:20:d7:b4:3f:58:3a:7a:92:ee:8f:3c:fa:2b:0a:72:03:9e:40:d4:eb:8b:8e:f6:98:f9:e7:f0:dd:ef:3c:25:f4:6c:33:84:56:4f:a7:91:93:48:04:0d:f3:02:9b:c6:1a:0f:f8:d1:38:6f:ef:c9:00:97:18:9b:32:2a:6c:29:a8:5d:6e:ea:07:07:23:81:e1:99:58:a2:d7:01:85:ff:ce:6d:47:fa:e6:40:91:7d:73:11:42:a3:8a:5a:46:4b:92:29:4f:3e:7d:f3:91:83:39:18:7c:5e:23:83:0d:67:54:a8:28:11:28:1d:ad:84:fe:e0:f0:05:05:71:69:d6:38:49:16:56:17:13:1d:ec:04:72:23:80:b3:d6:29:38:37:66:7a:00:b0:f7:31:f8:c0:80:41:03:c2:89:27:cb:0f:53:1a:fa:f8:3e:e6:c0:65:da:94:e7:5d:73:34:b0:68:6a:f6:ab:d8:e0:15:4e:5d:13:75:d8:fe:44:08:5b:9d:7d:7f:cf:2a:6a:93:e8:9f:bf:e7:77:0a:08:83:6b:c3:1b:be:8d:6e:d9:0f:27:b9:40:6b:29:55:26:47:a1:23:91:5f:dd:0e:b2:2c:51:a5:3a:e3:7b:ff:5a:9f:ee:13:bc:4b:0d:d8:42:e6:ba:65:2b:db:22:36:56:28:84:c4:cc:28:b0:24:8f:15:5e:58:15:9b:42:3e:d1:12:27:24:21:2a:5c:fb:2a:30:8b:7c:94:ac:ee:65:0a:03:40:2a:b0:8d:63:0f:b0:01:f0:2f:84:59:0e:7a:a3:e6:ea:43:f8:d4:81:d5:5d:5b:46:34:2f:d4:a2:07:1d:88:a5:22:47:f3:79:f4:87:d8:07:ea:36:bf:9e:06:31:6f:ae:6d:20:b7:06:88:4b:15:b8:68:fe:86:59:e5:7c:ae:94:86:4a:ef:9a:70:4c:79:9a:b8:22:1e:13:97:25:53:d8:af:a4:bc:0f:4f:1f:5b:d1:59:e8:f7:e0:29:12:5a:c5:81:d6:34:fd:82:99:e3:a1:9f:8c:e0:bd:b5:ae:06:db:95:49:d5:62:ac:32:65:8b:b7:3c:ab:7e:0c:1b:62:8a:6a:b9:97:7b:db:87:c5:76:9b:ec:c5:f2:2f:30:6e:66:dd:51:64:4e:13:aa:ce:c3:ad:b4:37:14:7f:23:13:a8:cd:a9:6a:7e:2d:c4:6e:7c:bb:13:49:d0:c8:d1:d3:75:02:11:42:d1:53:ea:8c:9f:02:03:01:00:01:a3:82:01:25:30:82:01:21:30:1d:06:03:55:1d:0e:04:16:04:14:ff:2f:7f:e1:06:f4:38:f3:2d:ed:25:8d:98:c2:fe:0e:f6:6c:fc:fa:30:1f:06:03:55:1d:23:04:18:30:16:80:14:e5:9d:59:30:82:47:58:cc:ac:fa:08:54:36:86:7b:3a:b5:04:4d:f0:30:0e:06:03:55:1d:0f:01:01:ff:04:04:03:02:01:86:30:1d:06:03:55:1d:25:04:16:30:14:06:08:2b:06:01:05:05:07:03:01:06:08:2b:06:01:05:05:07:03:02:30:12:06:03:55:1d:13:01:01:ff:04:08:30:06:01:01:ff:02:01:00:30:34:06:08:2b:06:01:05:05:07:01:01:04:28:30:26:30:24:06:08:2b:06:01:05:05:07:30:01:86:18:68:74:74:70:3a:2f:2f:6f:63:73:70:2e:64:69:67:69:63:65:72:74:2e:63:6f:6d:30:3a:06:03:55:1d:1f:04:33:30:31:30:2f:a0:2d:a0:2b:86:29:68:74:74:70:3a:2f:2f:63:72:6c:33:2e:64:69:67:69:63:65:72:74:2e:63:6f:6d:2f:4f:6d:6e:69:72:6f:6f:74:32:30:32:35:2e:63:72:6c:30:2a:06:03:55:1d:20:04:23:30:21:30:08:06:06:67:81:0c:01:02:01:30:08:06:06:67:81:0c:01:02:02:30:0b:06:09:2b:06:01:04:01:82:37:2a:01:30:0d:06:09:2a:86:48:86:f7:0d:01:01:0b:05:00:03:82:01:01:00:a0:d9:dd:7a:e5:d4:35:b4:74:b4:20:df:37:b8:e8:b8:4b:98:5e:2e:1b:31:fb:35:c8:3b:0b:71:9e:fc:02:59:d3:89:df:01:4b:41:a1:43:72:06:8c:b4:de:fd:52:33:08:15:52:14:79:d0:d9:06:cb:da:94:a9:f1:fb:a9:76:b4:cf:d5:1f:86:00:c8:d3:f1:fa:ed:4b:15:1d:23:a0:f6:29:41:82:db:35:89:1e:76:43:6e:85:19:84:05:eb:0f:aa:3e:1a:0f:3e:bc:64:32:3a:7c:9f:76:b2:3d:aa:d7:c4:2f:25:42:79:43:3e:f6:f0:0b:ed:14:e6:ad:f8:08:e0:2b:43:c5:a8:f6:04:02:f8:94:2a:bd:7a:d8:d0:75:5d:92:71:7f:ab:b2:22:35:25:9c:6e:14:11:d1:df:52:a7:61:97:44:7c:e2:63:2d:ad:82:0d:92:c4:f3:43:6b:07:60:cf:1f:12:1a:88:0a:d4:e5:71:12:eb:fc:51:2b:51:a3:d4:7b:de:b8:f2:7c:e2:4a:70:34:a8:a1:fb:ad:46:6a:3f:f2:1f:99:ba:3e:58:d6:52:64:6d:41:6e:03:a1:96:4f:b9:db:55:be:35:c8:a1:dc:74:5b:bd:10:44:d0:b5:98:4f:cb:d6:2a:77:e3:81:92:b1:c0:7c:09"]

    if controlla_oscp(chain)=="OCSP Status: GOOD":
        print(True)
    
    print(controlla_oscp(chain))